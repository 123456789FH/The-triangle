<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>حاسبة مساحة المثلث</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --pink:#ff4081;
      --pink2:#f50057;
      --border:#ff8ab4;
      --soft:#fff5f8;
      --card:#ffffff;
      --text:#2c3e50;
    }
    *{ box-sizing:border-box; font-family:'Cairo',system-ui,Segoe UI,Tahoma,sans-serif; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      background:linear-gradient(135deg,#ffd3e0 0%,#ffa7c4 100%);
      padding:20px;
    }
    .decorations{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:-1;
      overflow:hidden;
    }
    .container{
      background:var(--card);
      width:min(560px, 94vw);
      border-radius:16px;
      padding:22px;
      box-shadow:0 10px 30px rgba(0,0,0,.12);
    }
    h1{
      margin:0 0 12px;
      color:var(--pink);
      text-align:center;
      font-weight:800;
      letter-spacing:.2px;
    }

    /* Tabs */
    .tabs{
      display:flex;
      gap:10px;
      margin:10px 0 14px;
      background:var(--soft);
      border:1px solid rgba(255,64,129,.18);
      padding:8px;
      border-radius:14px;
    }
    .tab-btn{
      flex:1;
      border:none;
      cursor:pointer;
      padding:10px 12px;
      border-radius:12px;
      font-weight:800;
      background:#fff;
      color:var(--pink);
      border:1px solid rgba(255,64,129,.28);
      transition:background .25s ease, transform .08s ease;
    }
    .tab-btn:hover{ background:rgba(255,64,129,.06); }
    .tab-btn:active{ transform:scale(.99); }
    .tab-btn.active{
      background:var(--pink);
      color:#fff;
      border-color:transparent;
    }

    .triangle-wrap{
      background:var(--soft);
      border:1px solid rgba(255,64,129,.2);
      border-radius:14px;
      padding:10px;
      margin:10px 0 14px;
    }
    .triangle-display{ width:100%; height:240px; display:block; }

    .grid{
      display:grid;
      gap:10px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 560px){
      .grid{ grid-template-columns: 1fr 1fr; }
    }

    .input-group label{
      display:block;
      margin:0 0 6px;
      color:#333;
      font-weight:700;
    }
    input, select{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:10px;
      outline:none;
      background:#fff;
      font-size:16px;
    }
    input:focus, select:focus{
      border-color:var(--pink);
      box-shadow:0 0 0 3px rgba(255,64,129,.15);
    }

    .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    button.action{
      background:var(--pink);
      color:#fff;
      border:none;
      padding:12px 14px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      transition:transform .08s ease, background .25s ease;
      width:100%;
    }
    button.action:hover{ background:var(--pink2); }
    button.action:active{ transform:scale(.99); }
    .ghost{
      background:#fff !important;
      color:var(--pink) !important;
      border:1px solid rgba(255,64,129,.35) !important;
    }
    .ghost:hover{
      background:rgba(255,64,129,.06) !important;
      border-color:rgba(255,64,129,.55) !important;
    }

    .result{
      margin-top:12px;
      padding:14px;
      background:#fce4ec;
      border-radius:12px;
      text-align:center;
      line-height:1.9;
      color:#111;
      min-height:70px;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:6px;
    }
    .error{ color:#d32f2f; font-weight:800; }

    .examples-container{
      margin-top:16px;
      padding:12px;
      background:var(--soft);
      border-radius:14px;
      border:1px solid rgba(255,64,129,.15);
    }
    .examples-container h2{
      margin:0 0 10px;
      text-align:center;
      color:var(--pink);
      font-weight:800;
    }
    .example-card{
      background:#fff;
      padding:12px;
      border-radius:12px;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      animation:fadeIn .35s ease-in;
    }
    .example-card h3{ margin:0 0 6px; color:#333; }
    .example-card p{ margin:4px 0; color:#444; }
    .nav-buttons{
      display:flex;
      justify-content:space-between;
      gap:10px;
      margin-top:10px;
    }
    .nav-button{
      width:auto;
      padding:10px 12px;
      border-radius:12px;
      font-weight:800;
      border:none;
      cursor:pointer;
      background:var(--pink);
      color:#fff;
    }
    .nav-button:hover{ background:var(--pink2); }
    .nav-button:disabled{ opacity:.5; cursor:not-allowed; }

    footer{
      margin-top:14px;
      text-align:center;
      color:#666;
      font-size:13px;
    }

    @keyframes fadeIn{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }
    @keyframes float{ 0%{transform:translateY(0)} 50%{transform:translateY(-18px)} 100%{transform:translateY(0)} }
    @keyframes twinkle{ 0%{opacity:.25} 50%{opacity:1} 100%{opacity:.25} }
    .balloon{ position:absolute; animation: float 3s ease-in-out infinite; opacity:.9; }
    .star{ position:absolute; animation: twinkle 2s ease-in-out infinite; }

    .hide{ display:none !important; }

    @media print{
      body{ background:#fff; padding:0; }
      .decorations{ display:none !important; }
      .container{ box-shadow:none; width:100%; border-radius:0; }
    }
  </style>
</head>

<body>
  <div class="decorations" id="decorations"></div>

  <main class="container">
    <h1>حاسبة مساحة المثلث</h1>

    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="طرق الحساب">
      <button class="tab-btn active" id="tabBH" type="button" role="tab" aria-selected="true">
        بالقاعدة والارتفاع
      </button>
      <button class="tab-btn" id="tabHeron" type="button" role="tab" aria-selected="false">
        بالأضلاع الثلاثة (هيرون)
      </button>
    </div>

    <!-- Triangle -->
    <div class="triangle-wrap">
      <svg class="triangle-display" viewBox="0 0 240 240" id="triangleSvg" aria-label="رسم مثلث">
        <path id="triPath" d="M50 200 L190 200 L120 60 Z" fill="none" stroke="#ff4081" stroke-width="3"/>
        <line id="heightLine" x1="120" y1="60" x2="120" y2="200" stroke="rgba(255,64,129,.65)" stroke-width="2" stroke-dasharray="5 5" />

        <!-- labels for BH -->
        <text id="labelBase" fill="#333" font-size="14" font-weight="800"></text>
        <text id="labelHeight" fill="#333" font-size="14" font-weight="800"></text>

        <!-- labels for sides (Heron) -->
        <text id="labelA" fill="#333" font-size="14" font-weight="800"></text>
        <text id="labelB" fill="#333" font-size="14" font-weight="800"></text>
        <text id="labelC" fill="#333" font-size="14" font-weight="800"></text>
      </svg>
    </div>

    <!-- Inputs -->
    <section class="grid" aria-label="مدخلات الحساب">
      <div class="input-group">
        <label for="unit">الوحدة</label>
        <select id="unit">
          <option value="سم">سم</option>
          <option value="م">م</option>
          <option value="مم">مم</option>
          <option value="كم">كم</option>
        </select>
      </div>

      <div class="input-group">
        <label>معلومة</label>
        <div id="infoBox" style="padding:10px 12px;background:#fff;border:1px dashed rgba(255,64,129,.35);border-radius:10px;color:#444;line-height:1.7">
          القانون: <strong>المساحة = ½ × القاعدة × الارتفاع</strong>
        </div>
      </div>

      <!-- Base & Height -->
      <div id="bhInputs" class="grid" style="grid-column:1/-1; display:grid; gap:10px; grid-template-columns:1fr;">
        <div class="input-group">
          <label for="base">القاعدة (b)</label>
          <input type="number" id="base" placeholder="أدخل طول القاعدة" min="0" step="0.1" inputmode="decimal" />
        </div>

        <div class="input-group">
          <label for="height">الارتفاع (h)</label>
          <input type="number" id="height" placeholder="أدخل الارتفاع" min="0" step="0.1" inputmode="decimal" />
        </div>
      </div>

      <!-- Heron -->
      <div id="heronInputs" class="grid hide" style="grid-column:1/-1; display:grid; gap:10px; grid-template-columns:1fr;">
        <div class="input-group">
          <label for="sideA">الضلع (a)</label>
          <input type="number" id="sideA" placeholder="أدخل طول الضلع a" min="0" step="0.1" inputmode="decimal" />
        </div>

        <div class="input-group">
          <label for="sideB">الضلع (b)</label>
          <input type="number" id="sideB" placeholder="أدخل طول الضلع b" min="0" step="0.1" inputmode="decimal" />
        </div>

        <div class="input-group">
          <label for="sideC">الضلع (c)</label>
          <input type="number" id="sideC" placeholder="أدخل طول الضلع c" min="0" step="0.1" inputmode="decimal" />
        </div>
      </div>
    </section>

    <!-- Actions -->
    <div class="actions">
      <button id="calcBtn" type="button" class="action">احسب المساحة</button>
      <button id="resetBtn" type="button" class="action ghost">تفريغ</button>
    </div>

    <!-- Result -->
    <div class="result" id="result" role="status" aria-live="polite">
      ستظهر المساحة هنا
    </div>

    <!-- Examples -->
    <section class="examples-container" aria-label="أمثلة تطبيقية">
      <h2>أمثلة تطبيقية</h2>
      <div class="example-card" id="exampleCard"></div>
      <div class="nav-buttons">
        <button type="button" class="nav-button" id="prevButton">السابق</button>
        <button type="button" class="nav-button" id="nextButton">التالي</button>
      </div>
    </section>

    <footer>
      إعداد: أ/ فاطمة هزازي — الملتقى التفاعلي
    </footer>
  </main>

  <script>
    // ===== Helpers =====
    function toArabicDigits(value) {
      const map = ['٠','١','٢','٣','٤','٥','٦','٧','٨','٩'];
      return String(value).replace(/\d/g, d => map[Number(d)]);
    }

    function formatNum(n, decimals=2) {
      const fixed = Number(n).toFixed(decimals);
      const shown = fixed.replace('.', '٫');
      return toArabicDigits(shown);
    }

    function setText(el, text){ if(el) el.textContent = text; }

    // ===== State =====
    let mode = 'bh'; // 'bh' | 'heron'
    let currentExampleIndex = 0;

    const examples = [
      // Base & Height
      { mode:'bh', title:'مثال ١: مثلث متساوي الساقين', base:6, height:4,
        lines: (unit)=>[
          `القاعدة: ${formatNum(6,1)} ${toArabicDigits(unit)}`,
          `الارتفاع: ${formatNum(4,1)} ${toArabicDigits(unit)}`,
          `المساحة = ½ × ٦ × ٤ = ١٢ ${toArabicDigits(unit)}²`
        ]},
      { mode:'bh', title:'مثال ٢: مثلث قائم الزاوية', base:3, height:8,
        lines: (unit)=>[
          `القاعدة: ${formatNum(3,1)} ${toArabicDigits(unit)}`,
          `الارتفاع: ${formatNum(8,1)} ${toArabicDigits(unit)}`,
          `المساحة = ½ × ٣ × ٨ = ١٢ ${toArabicDigits(unit)}²`
        ]},
      { mode:'bh', title:'مثال ٣: مثلث حاد الزوايا', base:5, height:5,
        lines: (unit)=>[
          `القاعدة: ${formatNum(5,1)} ${toArabicDigits(unit)}`,
          `الارتفاع: ${formatNum(5,1)} ${toArabicDigits(unit)}`,
          `المساحة = ½ × ٥ × ٥ = ١٢٫٥ ${toArabicDigits(unit)}²`
        ]},

      // Heron
      { mode:'heron', title:'مثال ١: مثلث (٣-٤-٥)', a:3, b:4, c:5,
        lines: (unit)=>[
          `a = ${formatNum(3,1)} ${toArabicDigits(unit)}`,
          `b = ${formatNum(4,1)} ${toArabicDigits(unit)}`,
          `c = ${formatNum(5,1)} ${toArabicDigits(unit)}`,
          `المساحة = ٦ ${toArabicDigits(unit)}²`
        ]},
      { mode:'heron', title:'مثال ٢: مثلث (٦-٧-٨)', a:6, b:7, c:8,
        lines: (unit)=>[
          `a = ${formatNum(6,1)} ${toArabicDigits(unit)}`,
          `b = ${formatNum(7,1)} ${toArabicDigits(unit)}`,
          `c = ${formatNum(8,1)} ${toArabicDigits(unit)}`,
          `المساحة ≈ ٢٠٫٣٤ ${toArabicDigits(unit)}²`
        ]},
      { mode:'heron', title:'مثال ٣: مثلث متساوي الأضلاع (٦-٦-٦)', a:6, b:6, c:6,
        lines: (unit)=>[
          `a = ${formatNum(6,1)} ${toArabicDigits(unit)}`,
          `b = ${formatNum(6,1)} ${toArabicDigits(unit)}`,
          `c = ${formatNum(6,1)} ${toArabicDigits(unit)}`,
          `المساحة ≈ ١٥٫٥٩ ${toArabicDigits(unit)}²`
        ]},
    ];

    function filteredExamples(){
      return examples.filter(e => e.mode === mode);
    }

    // ===== Triangle Drawing =====
    function showLabelsBH(show){
      document.getElementById('labelBase').style.display = show ? 'block' : 'none';
      document.getElementById('labelHeight').style.display = show ? 'block' : 'none';
      document.getElementById('heightLine').style.display = show ? 'block' : 'none';
    }
    function showLabelsSides(show){
      document.getElementById('labelA').style.display = show ? 'block' : 'none';
      document.getElementById('labelB').style.display = show ? 'block' : 'none';
      document.getElementById('labelC').style.display = show ? 'block' : 'none';
    }

    function updateTriangleBH(base, height, unit) {
      const path = document.getElementById('triPath');
      const heightLine = document.getElementById('heightLine');

      const viewW = 240;
      const baseY = 205;
      const centerX = 120;

      const maxW = 160, maxH = 135;
      const scale = Math.min(maxW / base, maxH / height);

      const scaledBase = base * scale;
      const scaledHeight = height * scale;

      const x1 = centerX - (scaledBase / 2);
      const x2 = centerX + (scaledBase / 2);
      const apexY = baseY - scaledHeight;

      path.setAttribute('d', `M${x1} ${baseY} L${x2} ${baseY} L${centerX} ${apexY} Z`);

      // height line
      heightLine.setAttribute('x1', centerX);
      heightLine.setAttribute('y1', apexY);
      heightLine.setAttribute('x2', centerX);
      heightLine.setAttribute('y2', baseY);

      // Labels
      const labelBase = document.getElementById('labelBase');
      labelBase.setAttribute('x', centerX);
      labelBase.setAttribute('y', baseY - 8);
      labelBase.setAttribute('text-anchor', 'middle');
      setText(labelBase, `b = ${formatNum(base,1)} ${toArabicDigits(unit)}`);

      const labelHeight = document.getElementById('labelHeight');
      labelHeight.setAttribute('x', centerX + 10);
      labelHeight.setAttribute('y', (apexY + baseY) / 2);
      labelHeight.setAttribute('text-anchor', 'start');
      setText(labelHeight, `h = ${formatNum(height,1)} ${toArabicDigits(unit)}`);
    }

    function updateTriangleSides(a, b, c, unit) {
      // Place base AB = c, A(0,0), B(c,0), AC=b, BC=a
      const path = document.getElementById('triPath');
      const viewW = 240;
      const baseY = 210;

      // coords in math plane (y up)
      const x = (b*b + c*c - a*a) / (2*c);
      let y2 = b*b - x*x;
      if (y2 < 0) y2 = 0; // float safety
      const y = Math.sqrt(y2);

      // bounding
      const minX = Math.min(0, c, x);
      const maxX = Math.max(0, c, x);
      const width = Math.max(1e-6, maxX - minX);
      const height = Math.max(1e-6, y);

      const maxW = 180, maxH = 140;
      const scale = Math.min(maxW / width, maxH / height);

      const scaledW = width * scale;
      const startX = (viewW - scaledW)/2 - minX*scale;

      const Ax = startX + 0*scale;
      const Ay = baseY;

      const Bx = startX + c*scale;
      const By = baseY;

      const Cx = startX + x*scale;
      const Cy = baseY - y*scale;

      path.setAttribute('d', `M${Ax} ${Ay} L${Bx} ${By} L${Cx} ${Cy} Z`);

      // Labels (midpoints)
      const labelC = document.getElementById('labelC');
      labelC.setAttribute('x', (Ax + Bx)/2);
      labelC.setAttribute('y', baseY - 8);
      labelC.setAttribute('text-anchor', 'middle');
      setText(labelC, `c = ${formatNum(c,1)} ${toArabicDigits(unit)}`);

      const labelB = document.getElementById('labelB');
      labelB.setAttribute('x', (Ax + Cx)/2 - 6);
      labelB.setAttribute('y', (Ay + Cy)/2 - 6);
      labelB.setAttribute('text-anchor', 'middle');
      setText(labelB, `b = ${formatNum(b,1)} ${toArabicDigits(unit)}`);

      const labelA = document.getElementById('labelA');
      labelA.setAttribute('x', (Bx + Cx)/2 + 6);
      labelA.setAttribute('y', (By + Cy)/2 - 6);
      labelA.setAttribute('text-anchor', 'middle');
      setText(labelA, `a = ${formatNum(a,1)} ${toArabicDigits(unit)}`);
    }

    // ===== Calculations =====
    function calcBH(base, height){
      return (base * height) / 2;
    }

    function isValidTriangle(a,b,c){
      return a>0 && b>0 && c>0 && (a+b>c) && (a+c>b) && (b+c>a);
    }

    function calcHeron(a,b,c){
      const s = (a+b+c)/2;
      const area2 = s*(s-a)*(s-b)*(s-c);
      return { s, area: area2>0 ? Math.sqrt(area2) : 0 };
    }

    function calculate() {
      const unit = document.getElementById('unit').value;
      const resultDiv = document.getElementById('result');

      if (mode === 'bh') {
        const base = parseFloat(document.getElementById('base').value);
        const height = parseFloat(document.getElementById('height').value);

        if (isNaN(base) || isNaN(height)) {
          resultDiv.innerHTML = '<div class="error">الرجاء إدخال أرقام صحيحة للقاعدة والارتفاع</div>';
          return;
        }
        if (base <= 0 || height <= 0) {
          resultDiv.innerHTML = '<div class="error">يجب أن تكون القاعدة والارتفاع أكبر من الصفر</div>';
          return;
        }

        const area = calcBH(base, height);

        showLabelsBH(true);
        showLabelsSides(false);
        updateTriangleBH(base, height, unit);

        resultDiv.innerHTML = `
          <div><strong>المساحة = ½ × القاعدة × الارتفاع</strong></div>
          <div>المساحة = ½ × ${formatNum(base,1)} × ${formatNum(height,1)}</div>
          <div style="font-weight:900">
            المساحة = ${formatNum(area,2)} ${toArabicDigits(unit)}²
          </div>
        `;
        return;
      }

      // Heron
      const a = parseFloat(document.getElementById('sideA').value);
      const b = parseFloat(document.getElementById('sideB').value);
      const c = parseFloat(document.getElementById('sideC').value);

      if (isNaN(a) || isNaN(b) || isNaN(c)) {
        resultDiv.innerHTML = '<div class="error">الرجاء إدخال أرقام صحيحة للأضلاع الثلاثة</div>';
        return;
      }
      if (!isValidTriangle(a,b,c)) {
        resultDiv.innerHTML = '<div class="error">الأضلاع لا تكوّن مثلثًا (تحقق من شرط: مجموع ضلعين أكبر من الثالث)</div>';
        // ارسم شكل افتراضي لطيف
        showLabelsBH(false);
        showLabelsSides(true);
        updateTriangleSides(5,4,6, unit);
        return;
      }

      const { s, area } = calcHeron(a,b,c);

      showLabelsBH(false);
      showLabelsSides(true);
      updateTriangleSides(a,b,c, unit);

      resultDiv.innerHTML = `
        <div><strong>قانون هيرون</strong></div>
        <div>نصف المحيط (s) = (a + b + c) ÷ ٢</div>
        <div>s = (${formatNum(a,1)} + ${formatNum(b,1)} + ${formatNum(c,1)}) ÷ ٢ = ${formatNum(s,2)}</div>
        <div style="font-weight:900">
          المساحة = ${formatNum(area,2)} ${toArabicDigits(unit)}²
        </div>
      `;
    }

    // ===== UI Mode =====
    function setMode(newMode){
      mode = newMode;

      const tabBH = document.getElementById('tabBH');
      const tabHeron = document.getElementById('tabHeron');
      const bhInputs = document.getElementById('bhInputs');
      const heronInputs = document.getElementById('heronInputs');
      const infoBox = document.getElementById('infoBox');

      tabBH.classList.toggle('active', mode === 'bh');
      tabHeron.classList.toggle('active', mode === 'heron');
      tabBH.setAttribute('aria-selected', mode === 'bh' ? 'true' : 'false');
      tabHeron.setAttribute('aria-selected', mode === 'heron' ? 'true' : 'false');

      bhInputs.classList.toggle('hide', mode !== 'bh');
      heronInputs.classList.toggle('hide', mode !== 'heron');

      if (mode === 'bh'){
        infoBox.innerHTML = `القانون: <strong>المساحة = ½ × القاعدة × الارتفاع</strong>`;
        // رسم افتراضي
        showLabelsBH(true); showLabelsSides(false);
        updateTriangleBH(5, 4, document.getElementById('unit').value);
      } else {
        infoBox.innerHTML = `القانون: <strong>المساحة = √(s(s−a)(s−b)(s−c))</strong><br>حيث <strong>s = (a + b + c) ÷ ٢</strong>`;
        showLabelsBH(false); showLabelsSides(true);
        updateTriangleSides(5, 4, 6, document.getElementById('unit').value);
      }

      // أمثلة
      currentExampleIndex = 0;
      renderExample();
      // نظّف النتيجة
      document.getElementById('result').textContent = 'ستظهر المساحة هنا';
    }

    // ===== Examples =====
    function renderExample(){
      const unit = document.getElementById('unit').value;
      const list = filteredExamples();
      const card = document.getElementById('exampleCard');
      const prevBtn = document.getElementById('prevButton');
      const nextBtn = document.getElementById('nextButton');

      const ex = list[currentExampleIndex];

      const linesHtml = ex.lines(unit).map(t => `<p>${t}</p>`).join('');
      card.innerHTML = `
        <h3>${ex.title}</h3>
        ${linesHtml}
        <button type="button" class="nav-button" id="applyExampleBtn">طبق هذا المثال</button>
      `;

      prevBtn.disabled = currentExampleIndex === 0;
      nextBtn.disabled = currentExampleIndex === list.length - 1;

      document.getElementById('applyExampleBtn').addEventListener('click', () => {
        if (mode === 'bh'){
          document.getElementById('base').value = ex.base;
          document.getElementById('height').value = ex.height;
        } else {
          document.getElementById('sideA').value = ex.a;
          document.getElementById('sideB').value = ex.b;
          document.getElementById('sideC').value = ex.c;
        }
        calculate();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    }

    function nextExample(){
      const list = filteredExamples();
      if (currentExampleIndex < list.length - 1){
        currentExampleIndex++;
        renderExample();
      }
    }
    function previousExample(){
      if (currentExampleIndex > 0){
        currentExampleIndex--;
        renderExample();
      }
    }

    // ===== Decorations =====
    function createDecorations() {
      const decorations = document.getElementById('decorations');

      for (let i = 0; i < 10; i++) {
        const balloon = document.createElement('div');
        balloon.className = 'balloon';
        balloon.style.left = Math.random() * 100 + 'vw';
        balloon.style.top = Math.random() * 100 + 'vh';
        balloon.style.animationDelay = (Math.random() * 2) + 's';
        balloon.innerHTML = `
          <svg width="44" height="66" viewBox="0 0 44 66" aria-hidden="true">
            <path d="M22 44c12 0 22-10 22-22S34 0 22 0 0 10 0 22s10 22 22 22zm0 2v18"
              fill="hsl(${Math.random() * 360}, 85%, 72%)" stroke="rgba(0,0,0,.25)" stroke-width="1"/>
          </svg>
        `;
        decorations.appendChild(balloon);
      }

      for (let i = 0; i < 20; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + 'vw';
        star.style.top = Math.random() * 100 + 'vh';
        star.style.animationDelay = (Math.random() * 2) + 's';
        star.innerHTML = `
          <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 0l2.4 7.8H22l-6.2 4.8 2.4 7.8-6.2-4.8-6.2 4.8 2.4-7.8L2 7.8h7.6z"
              fill="#FFD700" opacity="0.9"/>
          </svg>
        `;
        decorations.appendChild(star);
      }
    }

    // ===== Events =====
    document.getElementById('calcBtn').addEventListener('click', calculate);
    document.getElementById('resetBtn').addEventListener('click', () => {
      // clear all inputs
      ['base','height','sideA','sideB','sideC'].forEach(id => document.getElementById(id).value = '');
      document.getElementById('result').textContent = 'ستظهر المساحة هنا';

      const unit = document.getElementById('unit').value;
      if (mode === 'bh'){
        showLabelsBH(true); showLabelsSides(false);
        updateTriangleBH(5,4, unit);
      } else {
        showLabelsBH(false); showLabelsSides(true);
        updateTriangleSides(5,4,6, unit);
      }
    });

    document.getElementById('prevButton').addEventListener('click', previousExample);
    document.getElementById('nextButton').addEventListener('click', nextExample);

    document.getElementById('tabBH').addEventListener('click', () => setMode('bh'));
    document.getElementById('tabHeron').addEventListener('click', () => setMode('heron'));

    // Enter triggers calculate (on any input)
    ['base','height','sideA','sideB','sideC'].forEach(id => {
      document.getElementById(id).addEventListener('keydown', (e) => {
        if (e.key === 'Enter') calculate();
      });
    });

    document.getElementById('unit').addEventListener('change', () => {
      // just re-render labels/examples & redraw default/current if inputs empty
      renderExample();
      const unit = document.getElementById('unit').value;

      if (mode === 'bh'){
        const base = parseFloat(document.getElementById('base').value);
        const height = parseFloat(document.getElementById('height').value);
        if (!isNaN(base) && base>0 && !isNaN(height) && height>0) calculate();
        else updateTriangleBH(5,4, unit);
      } else {
        const a = parseFloat(document.getElementById('sideA').value);
        const b = parseFloat(document.getElementById('sideB').value);
        const c = parseFloat(document.getElementById('sideC').value);
        if (!isNaN(a)&&!isNaN(b)&&!isNaN(c) && isValidTriangle(a,b,c)) calculate();
        else updateTriangleSides(5,4,6, unit);
      }
    });

    // ===== Init =====
    createDecorations();
    setMode('bh');
  </script>
</body>
</html>
